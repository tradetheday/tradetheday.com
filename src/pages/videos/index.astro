---
import BaseLayout from '../../layouts/BaseLayout.astro';
import VideoEmbed from '../../components/VideoEmbed.astro';
import { videos, getFeaturedVideos, getVideoCategories, getVideosByCategory } from '../../data/videos';

const featuredVideos = getFeaturedVideos();
const categories = getVideoCategories();
const latestVideo = featuredVideos[0];

const pageTitle = "Trading Videos & Tutorials | TradeTheDay";
const pageDescription = "Free trading videos, broker reviews, tutorials, and strategies. Learn to trade forex, crypto, and stocks with our expert video guides.";
---

<BaseLayout title={pageTitle} description={pageDescription}>
  <div class="videos-page">
    <!-- Hero with Featured Video -->
    <section class="videos-hero">
      <div class="container">
        <div class="hero-grid">
          <div class="hero-video">
            <VideoEmbed
              videoId={latestVideo.videoId}
              title={latestVideo.title}
              description={latestVideo.description}
              duration={latestVideo.duration}
              variant="full"
              showInfo={false}
            />
          </div>
          <div class="hero-info">
            <div class="hero-badge">LATEST VIDEO</div>
            <h1 class="hero-title">{latestVideo.title}</h1>
            <p class="hero-desc">{latestVideo.description}</p>
            <div class="hero-meta">
              <span class="meta-duration">{latestVideo.duration}</span>
              <span class="meta-date">{new Date(latestVideo.publishDate).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</span>
            </div>
            <div class="hero-tags">
              {latestVideo.tags.slice(0, 3).map(tag => (
                <span class="tag">{tag}</span>
              ))}
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Category Navigation -->
    <section class="category-nav">
      <div class="container">
        <div class="category-tabs">
          <button class="category-tab active" data-category="all">
            All Videos
            <span class="tab-count">{videos.length}</span>
          </button>
          {categories.filter(c => c.count > 0).map(cat => (
            <button class="category-tab" data-category={cat.category}>
              {cat.label}
              <span class="tab-count">{cat.count}</span>
            </button>
          ))}
        </div>
      </div>
    </section>

    <!-- Video Grid -->
    <section class="videos-grid-section">
      <div class="container">
        <div class="videos-grid" id="videosGrid">
          {videos.map(video => (
            <div class="video-card-wrapper" data-category={video.category}>
              <VideoEmbed
                videoId={video.videoId}
                title={video.title}
                description={video.description}
                duration={video.duration}
                variant="card"
              />
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- Subscribe CTA -->
    <section class="subscribe-section">
      <div class="container">
        <div class="subscribe-box">
          <div class="subscribe-icon">üîî</div>
          <div class="subscribe-content">
            <h2>Never Miss a Video</h2>
            <p>Subscribe to our YouTube channel for weekly trading content, broker reviews, and market analysis.</p>
          </div>
          <a href="https://youtube.com/@tradetheday" class="subscribe-btn" target="_blank" rel="noopener">
            <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
              <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
            </svg>
            Subscribe on YouTube
          </a>
        </div>
      </div>
    </section>

    <!-- Why Watch Section -->
    <section class="why-section">
      <div class="container">
        <h2 class="section-title">Learn Trading the Right Way</h2>
        <div class="why-grid">
          <div class="why-card">
            <div class="why-icon">üéØ</div>
            <h3>Actionable Strategies</h3>
            <p>No fluff. Every video teaches you something you can use immediately in your trading.</p>
          </div>
          <div class="why-card">
            <div class="why-icon">üìä</div>
            <h3>Real Examples</h3>
            <p>Live trading, real charts, actual results. See strategies in action, not just theory.</p>
          </div>
          <div class="why-card">
            <div class="why-icon">üîç</div>
            <h3>Honest Reviews</h3>
            <p>We test brokers with real money and share the truth - good and bad.</p>
          </div>
          <div class="why-card">
            <div class="why-icon">üìÖ</div>
            <h3>Weekly Content</h3>
            <p>New videos every week covering the latest in trading, brokers, and market analysis.</p>
          </div>
        </div>
      </div>
    </section>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const tabs = document.querySelectorAll('.category-tab');
      const cards = document.querySelectorAll('.video-card-wrapper');

      tabs.forEach(tab => {
        tab.addEventListener('click', () => {
          // Update active tab
          tabs.forEach(t => t.classList.remove('active'));
          tab.classList.add('active');

          // Filter videos
          const category = tab.dataset.category;

          cards.forEach(card => {
            if (category === 'all' || card.dataset.category === category) {
              card.style.display = 'block';
            } else {
              card.style.display = 'none';
            }
          });
        });
      });
    });
  </script>

  <style>
    .videos-page {
      background: var(--black);
    }

    /* Hero */
    .videos-hero {
      padding: var(--space-2xl) 0;
      background: linear-gradient(180deg, rgba(255, 72, 0, 0.1) 0%, transparent 100%);
    }

    .hero-grid {
      display: grid;
      grid-template-columns: 1.5fr 1fr;
      gap: var(--space-2xl);
      align-items: center;
    }

    @media (max-width: 968px) {
      .hero-grid {
        grid-template-columns: 1fr;
      }
    }

    .hero-badge {
      display: inline-block;
      background: var(--orange);
      color: var(--white);
      padding: var(--space-xs) var(--space-md);
      border-radius: 100px;
      font-size: var(--text-xs);
      font-weight: 700;
      margin-bottom: var(--space-md);
    }

    .hero-title {
      font-size: var(--text-3xl);
      font-weight: 800;
      margin-bottom: var(--space-md);
      line-height: 1.2;
    }

    .hero-desc {
      color: var(--text-secondary);
      margin-bottom: var(--space-md);
      line-height: 1.6;
    }

    .hero-meta {
      display: flex;
      gap: var(--space-md);
      margin-bottom: var(--space-md);
      font-size: var(--text-sm);
      color: var(--text-secondary);
    }

    .meta-duration::before {
      content: "‚è± ";
    }

    .meta-date::before {
      content: "üìÖ ";
    }

    .hero-tags {
      display: flex;
      gap: var(--space-sm);
    }

    .tag {
      background: var(--gray-800);
      color: var(--text-secondary);
      padding: var(--space-xs) var(--space-sm);
      border-radius: var(--radius-sm);
      font-size: var(--text-xs);
    }

    /* Category Navigation */
    .category-nav {
      padding: var(--space-lg) 0;
      border-bottom: 1px solid var(--gray-800);
      position: sticky;
      top: 56px;
      background: var(--black);
      z-index: 100;
    }

    .category-tabs {
      display: flex;
      gap: var(--space-sm);
      overflow-x: auto;
      padding-bottom: var(--space-xs);
      -webkit-overflow-scrolling: touch;
    }

    .category-tab {
      display: flex;
      align-items: center;
      gap: var(--space-xs);
      padding: var(--space-sm) var(--space-md);
      background: var(--gray-900);
      border: 1px solid var(--gray-800);
      border-radius: var(--radius-md);
      color: var(--text-secondary);
      font-weight: 600;
      font-size: var(--text-sm);
      cursor: pointer;
      white-space: nowrap;
      transition: all 0.2s;
    }

    .category-tab:hover {
      border-color: var(--gray-700);
      color: var(--white);
    }

    .category-tab.active {
      background: var(--orange);
      border-color: var(--orange);
      color: var(--white);
    }

    .tab-count {
      background: rgba(255, 255, 255, 0.2);
      padding: 2px 6px;
      border-radius: 100px;
      font-size: var(--text-xs);
    }

    .category-tab.active .tab-count {
      background: rgba(255, 255, 255, 0.3);
    }

    /* Videos Grid */
    .videos-grid-section {
      padding: var(--space-2xl) 0;
    }

    .videos-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: var(--space-lg);
    }

    @media (max-width: 968px) {
      .videos-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 600px) {
      .videos-grid {
        grid-template-columns: 1fr;
      }
    }

    /* Subscribe Section */
    .subscribe-section {
      padding: var(--space-2xl) 0;
      background: var(--gray-950);
    }

    .subscribe-box {
      display: flex;
      align-items: center;
      gap: var(--space-xl);
      padding: var(--space-xl);
      background: linear-gradient(135deg, #c4302b 0%, #8b0000 100%);
      border-radius: var(--radius-xl);
    }

    @media (max-width: 768px) {
      .subscribe-box {
        flex-direction: column;
        text-align: center;
      }
    }

    .subscribe-icon {
      font-size: 3rem;
      flex-shrink: 0;
    }

    .subscribe-content {
      flex: 1;
    }

    .subscribe-content h2 {
      font-size: var(--text-xl);
      margin-bottom: var(--space-xs);
    }

    .subscribe-content p {
      opacity: 0.9;
    }

    .subscribe-btn {
      display: inline-flex;
      align-items: center;
      gap: var(--space-sm);
      padding: var(--space-md) var(--space-xl);
      background: var(--white);
      color: #c4302b;
      border-radius: var(--radius-md);
      font-weight: 700;
      text-decoration: none;
      transition: all 0.2s;
      white-space: nowrap;
    }

    .subscribe-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    /* Why Section */
    .why-section {
      padding: var(--space-3xl) 0;
    }

    .section-title {
      font-size: var(--text-2xl);
      font-weight: 700;
      text-align: center;
      margin-bottom: var(--space-2xl);
    }

    .why-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: var(--space-lg);
    }

    @media (max-width: 968px) {
      .why-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 500px) {
      .why-grid {
        grid-template-columns: 1fr;
      }
    }

    .why-card {
      text-align: center;
      padding: var(--space-lg);
      background: var(--gray-900);
      border-radius: var(--radius-lg);
      border: 1px solid var(--gray-800);
    }

    .why-icon {
      font-size: 2.5rem;
      margin-bottom: var(--space-md);
    }

    .why-card h3 {
      font-size: var(--text-md);
      margin-bottom: var(--space-sm);
    }

    .why-card p {
      font-size: var(--text-sm);
      color: var(--text-secondary);
      line-height: 1.6;
    }
  </style>
</BaseLayout>
